!function(){"use strict";new Vue({el:"#app",data:{gas:"https://script.google.com/macros/s/AKfycbwyY7oLpoZ4lbcIwIWniLZ8U_pY8e7YBK9fakeszgR_77S2u1SV/exec",id:"",persons:{},person:{},formAction:"https://docs.google.com/spreadsheets/d/1MsiTx6f7h6PPZtlZxzaWlCoM7LsziMJvOqBJhuIXIeo/edit#gid=0",input:{id:"entry.664306583",name:"entry.1543576845",department:"entry.892230025",msg:"entry.1003128242"},loading:!1},methods:{limitIdLen:function(t){if(t.length>4)return this.id=this.id.slice(0,4)},submit:function(){var t=this;if(void 0!==this.person.name){var n="".concat(this.input.id,"=").concat(this.person.id,"&").concat(this.input.name,"=").concat(this.person.name,"&").concat(this.input.department,"=").concat(this.person.department,"&").concat(this.input.msg,"=").concat(this.person.message||"無");fetch(this.formAction+"?"+n,{method:"POST"}).catch((function(n){alert("提交成功。"),t.id="",t.person={}}))}}},watch:{id:function(t){var n=this;if(4===t.length)if(void 0===this.persons[this.id]){this.loading=!0;var i=this.gas+"?id="+this.id;fetch(i,{method:"POST"}).then((function(t){return t.json()})).then((function(t){n.persons[n.id]=t,n.person=t,n.loading=!1}))}else this.person=this.persons[this.id]}}})}();